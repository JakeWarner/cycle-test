version: "1.0"
description: "A test spec for Cycle v2"
containers:
  db:
    name: "Database"
    image:
      name: "MongoDB"
      source: 
        docker_hub:
          target: "mongo:3.6"
      preload: false
    volumes:
      - destination: "/data/db"
        read_only: false
        remote_access:
          allow: false
        local: 
          max_size: "2G"
    config:
      runtime:
        command:
          path: "/entrypoint.sh"
          args: "mongod --auth --bind_ip_all"
        privileged: false
        namespaces: ["network", "ipc", "uts", "mount", "pid"]
      network:
        public: "enable"
        hostname: "db"
        ports: ["27017"]
        dns:
          nameservers: ["8.8.4.4", "8.8.8.8"]
      deployment:
        instances: 1
        tags:
          require: ["db"]
          pool: ["sjc", "nyc"]
      resources:
        cpu:
          limit: "0.5cores"
          reserve: "0.1cores"
        ram:
          limit: "2G"
          reserve: "250M"
      options:
        events:
          deploy:
            auto_restart: true
        monitor:
          auto_restart: true
          max_restarts: 3
          restart_delay_secs: 10
          notify:
            emails: ["jwarner@cycle.io"]
      
